# Excel 函數基礎 (3hr) 課程規劃

## 課程目標

* 熟悉 Excel 函數的基本概念與語法
* 掌握常用的運算、日期時間、邏輯函數
* 能將函數應用於資料整理與分析
* 透過實作練習強化實務應用能力

---

### 1.1 函數的基本概念與應用

**課程內容：**

* **函數語法結構**：`=函數名稱(參數1, 參數2, ...)`

  * 例：`=SUM(A1:A10)` → 將 A1 到 A10 的數值加總。
* **相對引用與絕對引用**：

  * **相對引用 (`A1`)**：公式複製到其他儲存格時，參照的行列會隨著位置改變。例如在 B2 輸入 `=A1+10`，複製到 B3 會自動變成 `=A2+10`。
  * **絕對引用 (`$A$1`)**：公式複製到其他儲存格時，參照的行列固定不變。例如 `=$A$1+10` 無論複製到哪裡都仍然參照 A1。
  * **混合引用**：

    * `$A1` → 鎖定欄，行隨位置改變
    * `A$1` → 鎖定行，欄隨位置改變
  * **說明**：使用相對與絕對引用可以控制公式在複製時的參照行列，方便做批量計算或動態範圍。
* **錯誤訊息解讀**：

  * **#DIV/0!**：當除數為 0 時出現，例如 `=10/0`。
  * **#N/A**：表示沒有可用值或找不到匹配，例如 `=VLOOKUP(5, A1:B3, 2, FALSE)` 查無結果。
  * **#VALUE!**：當數值或資料型態錯誤時，例如 `="文字"+5`。
* **函數嵌套與組合應用**：

  * 例：`=IF(AVERAGE(A1:A10)>=60, "及格", "不及格")`

**實作練習：**

1. 在工作表中輸入數據，嘗試使用 `=SUM(A1:A5)`
2. 建立一個公式，計算「加總後再取平均」：`=AVERAGE(SUM(A1:A3), SUM(B1:B3))`
3. 練習 `$A$1` vs `A1` 的差異，複製公式驗證結果。
4. 錯誤除錯：用 `=A1/B1` 測試分母為 0 的狀況，並用 `IFERROR` 包裝。
---

### 1.2 常用函數介紹 (90 min)

#### 運算函數

**函式名稱：SUM**

* **定義**：對指定範圍或數值加總。
* **使用語法**：`SUM(數值1, [數值2], ...)`
* **實際範例**：`=SUM(A1:A10)`。

**函式名稱：SUMIF**

* **定義**：根據單一條件加總。
* **使用語法**：`SUMIF(範圍, 條件, [加總範圍])`
* **實際範例**：`=SUMIF(B2:B10, ">1000", C2:C10)`。

**函式名稱：SUMIFS**

* **定義**：根據多條件加總。
* **使用語法**：`SUMIFS(加總範圍, 條件範圍1, 條件1, ...)`
* **實際範例**：`=SUMIFS(C2:C10, B2:B10, ">1000", D2:D10, "台北")`。

**函式名稱：ROUND**

* **定義**：四捨五入數值。
* **使用語法**：`ROUND(數值, 位數)`
* **實際範例**：`=ROUND(3.14159,2)` → 3.14。

**函式名稱：ROUNDUP**

* **定義**：無條件進位。
* **使用語法**：`ROUNDUP(數值, 位數)`
* **實際範例**：`=ROUNDUP(3.14159,2)` → 3.15。

**函式名稱：ROUNDDOWN**

* **定義**：無條件捨去。
* **使用語法**：`ROUNDDOWN(數值, 位數)`
* **實際範例**：`=ROUNDDOWN(3.14159,2)` → 3.14。

**函式名稱：ABS**

* **定義**：計算絕對值。
* **使用語法**：`ABS(數值)`
* **實際範例**：`=ABS(-10)` → 10。

**函式名稱：MOD**

* **定義**：取餘數。
* **使用語法**：`MOD(數值, 除數)`
* **實際範例**：`=MOD(10,3)` → 1。

**函式名稱：MAX**

* **定義**：求最大值。
* **使用語法**：`MAX(範圍)`
* **實際範例**：`=MAX(A1:A10)`。

**函式名稱：MIN**

* **定義**：求最小值。
* **使用語法**：`MIN(範圍)`
* **實際範例**：`=MIN(A1:A10)`。

**函式名稱：AVERAGE**

* **定義**：求平均值。
* **使用語法**：`AVERAGE(範圍)`
* **實際範例**：`=AVERAGE(A1:A10)`。

#### 日期與時間函數

**函式名稱：YEAR**

* **定義**：取年份。
* **使用語法**：`YEAR(日期)`
* **實際範例**：`=YEAR("2025/10/02")` → 2025。

**函式名稱：MONTH**

* **定義**：取月份。
* **使用語法**：`MONTH(日期)`
* **實際範例**：`=MONTH("2025/10/02")` → 10。

**函式名稱：DAY**

* **定義**：取日。
* **使用語法**：`DAY(日期)`
* **實際範例**：`=DAY("2025/10/02")` → 2。

**函式名稱：TODAY**

* **定義**：傳回今天日期。
* **使用語法**：`TODAY()`
* **實際範例**：`=TODAY()`。

**函式名稱：NOW**

* **定義**：傳回當前日期與時間。
* **使用語法**：`NOW()`
* **實際範例**：`=NOW()`。

**函式名稱：DATEVALUE**

* **定義**：將文字轉為日期。
* **使用語法**：`DATEVALUE(文字日期)`
* **實際範例**：`=DATEVALUE("2025/10/02")`。

**函式名稱：TIMEVALUE**

* **定義**：將文字轉為時間。
* **使用語法**：`TIMEVALUE(文字時間)`
* **實際範例**：`=TIMEVALUE("08:30")`。

**函式名稱：WEEKDAY**

* **定義**：回傳星期數字。
* **使用語法**：`WEEKDAY(日期, [回傳類型])`
* **實際範例**：`=WEEKDAY("2025/10/02")` → 5。

**函式名稱：NETWORKDAYS**

* **定義**：計算工作日天數。
* **使用語法**：`NETWORKDAYS(開始日期, 結束日期, [假日])`
* **實際範例**：`=NETWORKDAYS(A1,B1,Holidays)`。

#### 邏輯函數

**函式名稱：IF**

* **定義**：條件判斷。
* **使用語法**：`IF(條件, 值_if_true, 值_if_false)`
* **實際範例**：`=IF(A1>=60,"及格","不及格")`。

**函式名稱：IFS**

* **定義**：多重條件判斷。
* **使用語法**：`IFS(條件1, 結果1, 條件2, 結果2, ...)`
* **實際範例**：`=IFS(A1>=90,"A",A1>=80,"B",A1>=70,"C")`。

**函式名稱：AND**

* **定義**：同時滿足多個條件。
* **使用語法**：`AND(條件1, 條件2, ...)`
* **實際範例**：`=AND(A1>60,B1="台北")` → TRUE 或 FALSE。

**函式名稱：OR**

* **定義**：任一條件成立。
* **使用語法**：`OR(條件1, 條件2, ...)`
* **實際範例**：`=OR(A1>90,B1="台北")` → TRUE 或 FALSE。

**函式名稱：NOT**

* **定義**：邏輯反轉。
* **使用語法**：`NOT(條件)`
* **實際範例**：`=NOT(A1>60)` → TRUE 或 FALSE。

**函式名稱：IFERROR**

* **定義**：錯誤處理。
* **使用語法**：`IFERROR(值, 錯誤時回傳值)`
* **實際範例**：`=IFERROR(A1/B1,0)`。

**函式名稱：IFBLANK**

* **定義**：空白判斷。
* **使用語法**：`IF(A1="","待補",A1)`
* **實際範例**：若 A1 空白，回


### 函數總整理表格

| 函式名稱        | 用途       | 使用語法                          |
| ----------- | -------- | ----------------------------- |
| SUM         | 數值加總     | SUM(數值1, [數值2], ... )         |
| SUMIF       | 單一條件加總   | SUMIF(範圍, 條件, [加總範圍])         |
| SUMIFS      | 多條件加總    | SUMIFS(加總範圍, 條件範圍1, 條件1, ...) |
| ROUND       | 四捨五入     | ROUND(數值, 位數)                 |
| ROUNDUP     | 無條件進位    | ROUNDUP(數值, 位數)               |
| ROUNDDOWN   | 無條件捨去    | ROUNDDOWN(數值, 位數)             |
| ABS         | 絕對值      | ABS(數值)                       |
| MOD         | 取餘數      | MOD(數值, 除數)                   |
| MAX         | 最大值      | MAX(範圍)                       |
| MIN         | 最小值      | MIN(範圍)                       |
| AVERAGE     | 平均值      | AVERAGE(範圍)                   |
| YEAR        | 取年份      | YEAR(日期)                      |
| MONTH       | 取月份      | MONTH(日期)                     |
| DAY         | 取日       | DAY(日期)                       |
| TODAY       | 當天日期     | TODAY()                       |
| NOW         | 當前日期與時間  | NOW()                         |
| DATEVALUE   | 文字轉日期    | DATEVALUE(文字日期)               |
| TIMEVALUE   | 文字轉時間    | TIMEVALUE(文字時間)               |
| WEEKDAY     | 回傳星期數字   | WEEKDAY(日期,[回傳類型])            |
| NETWORKDAYS | 計算工作日天數  | NETWORKDAYS(開始日期, 結束日期, [假日]) |
| IF          | 條件判斷     | IF(條件, 值_if_true, 值_if_false) |
| IFS         | 多重條件判斷   | IFS(條件1, 結果1, 條件2, 結果2, ...)  |
| AND         | 同時滿足多個條件 | AND(條件1, 條件2, ...)            |
| OR          | 任一條件成立   | OR(條件1, 條件2, ...)             |
| NOT         | 邏輯反轉     | NOT(條件)                       |
| IFERROR     | 錯誤處理     | IFERROR(值, 錯誤時回傳值)            |
| IFBLANK     | 空白判斷與替換  | IF(A1="","待補",A1)             |

### 1.3 資料整理與函數應用

**數據清理技巧**

* **移除重複值與空白資料**：

  * Excel 功能：`資料 > 移除重複項目`
  * 範例：假設 A1:A10 有以下數據：

    ```
    Apple
    Banana
    Apple
    Orange
    Banana
    ```

    * 使用公式：`=UNIQUE(A1:A5)` → 結果：

    ```
    Apple
    Banana
    Orange
    ```
  * 移除空白資料：假設範圍 A1:A7 包含空白：

    ```
    Apple
    Banana

    Orange
    ```

    * 使用 `=FILTER(A1:A7,A1:A7<>")` → 結果：

    ```
    Apple
    Banana
    Orange
    ```
* **文字格式統一化**：

  * `TRIM(文字)` → 移除文字前後多餘空格

    * 範例：A1 = `  Apple  ` → `=TRIM(A1)` → 結果：`Apple`
  * `CLEAN(文字)` → 移除非列印字元

    * 範例：A2 = `Banana` + 換行符 (CHAR(10)) → `=CLEAN(A2)` → 結果：`Banana`
    * **說明非列印字元**：這些是存在於文字中但不會在畫面或列印上顯示的控制字符，如換行 (CHAR(10))、制表符 (CHAR(9)) 等。`CLEAN` 函數可以自動去掉這些字元，避免資料錯誤或格式混亂。
* **數值格式標準化**：

  * `VALUE(文字)` → 將文字轉數值，例如 `=VALUE("100")` → 100

**函數組合應用**

* **多層函數嵌套**：

  * 例：`=IF(AND(A1>60,B1="台北"),"通過","不通過")`
* **動態範圍應用**：

  * `OFFSET(起始儲存格, 列偏移, 欄偏移, 高度, 寬度)` 例：`=SUM(OFFSET(A1,0,0,5,1))`
  * `INDEX(範圍, 列號, [欄號])` 例：`=INDEX(A1:C10,2,3)` → 第二列第三欄的值
  * `MATCH(查詢值, 查詢範圍, 比對類型)` 例：`=MATCH(50,A1:A10,0)` → 找到 50 在範圍中的位置
* **條件格式化配合函數使用**：

  * 例：使用公式設定格式：`=A1<AVERAGE($A$1:$A$10)` → 將低於平均值的儲存格標紅

**實作練習**

1. 匯入一份混合資料，清理空白及多餘字元，轉換數值格式。
2. 用多層函數判斷成績及地區，建立通過/不通過標籤。
3. 使用 `OFFSET` + `SUM` 計算動態區間總和。
4. 設定條件格式，標示低於平均值的數字為紅色。
