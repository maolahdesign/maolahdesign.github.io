# 第四單元：AI 智能整合


## **單元一：認識你的新夥伴：AI 工具能做什麼？ (30分鐘)**

### **AI 工具是什麼？**

首先，讓我們先來認識一下今天的主角：生成式 AI。你可以把它想像成一個擁有海量知識、反應極快、而且 24 小時待命的超級大腦。它不僅能像朋友一樣跟你聊天，更能成為你工作上的得力助手。

### **AI 在數據分析中的三大角色**

在數據分析的領域，我們不該把 AI 看作一個取代者，而是一個「**智能副駕 (Co-pilot)**」。它能輔助我們完成許多任務，主要扮演以下三個關鍵角色：

1.  **探索者 (Explorer)**
    當你面對一堆原始數據，還沒有頭緒時，AI 就是你最好的探索夥伴。它可以幫你腦力激盪，提出各種值得分析的商業問題。

    *   **實作範例**：
        假設我們有一份銷售數據，欄位包含「日期、地區、產品、銷售額」。我們可以這樣問 AI：
        
        > 「我有一份銷售數據，欄位有『日期』、『地區』、『產品』、『銷售額』，我可以用這些數據回答哪些有趣的商業問題？」
    
2.  **翻譯官 (Translator)**
    AI 能將我們用「人類語言」描述的複雜問題，精準地「翻譯」成 Excel 能聽懂的語言——也就是具體的分析步驟或函數公式。

3.  **解讀者 (Interpreter)**
    當你從 Excel 得到分析結果（例如一張樞紐分析表）後，AI 可以幫助你快速解讀數據背後的趨勢與洞察，並生成初步的結論。

    *   **實作範例**：
        我們可以將一張簡單的樞紐分析表結果貼給 AI，然後問：
        
        > 「根據這張表格，你看到了什麼趨勢？請用三句話總結。」

---
#### 怎麼開始
- [ChatGPT](https://chatgpt.com/)
- [perplexity](https://www.perplexity.ai/)
- [gemini](https://gemini.google.com/app?hl=zh-TW)
- [claude](https://claude.ai/)
- [grok](https://grok.com/?referrer=website)
- [安裝 gemini CLI](https://ithelp.ithome.com.tw/articles/10382348)

---
### Prompt 的基本概念與定義

#### 什麼是 Prompt？

Prompt (提示詞) 是給 AI 的一段輸入文字或指令，目的是引導模型產生特定的回應、完成某項任務，或進行特定的對話。

可以將 Prompt 想像成是對一位非常聰明但需要明確指示的助理所說的話。說什麼，以及如何說，將直接決定助理如何理解並給出回應。

#### Prompt 的核心目的

Prompt 的存在，是為了讓 AI 能夠：

1. 理解您的意圖：AI 需要知道你想讓它做什麼。
2. 設定情境：提供足夠的背景資訊，讓 AI 能夠在正確的脈絡下思考。
3. 定義輸出：規範 AI 回應的內容、格式、語氣、長度等。

---

####  一個好的 Prompt 應具備的要素

要從 AI 中獲得最佳、最符合預期的回應，你的 Prompt 應盡可能具備以下要素：

1. 清晰明確 (Clarity & Specificity)
   * 定義：避免模糊不清的詞語，直接說明你想執行的 Excel 計算或操作。AI 模型是字面意義上的理解者，**它不會「猜測」你的意思**。
   * 範例：
       * 不好：「給我一個公式。」（太籠統，AI 不知道要算什麼）
       * 好：「**請**給我一個 Excel 公式，計算 `A1` 到 `A10` 儲存格的總和。」（明確指出要計算的動作、範圍和目標）
2. 提供足夠的情境 (Context)
   * 定義：給予 AI 足夠的背景資訊，例如你的**資料結構、Excel 版本、特殊需求**等，讓它能更好地理解你的需求並選擇最適合的函數。
   * 範例：
       * 「我有一個員工資料表，其中 A 欄是員工編號，B 欄是部門，C 欄是月薪。現在我需要根據員工編號 (在**另一個工作表**的 A2 儲存格)，從這個資料表中查找對應的月薪。我的 Excel 版本是 Microsoft 365。 請給我一個 Excel 公式。」（明確指出 Excel 版本和資料結構，影響 AI 選擇 VLOOKUP 而非 XLOOKUP）
3. 明確的指令 (Clear Instructions)
   * 定義：清楚地告訴 AI 你希望它執行什麼具體的 Excel 動作（例如：計算、查找、篩選、格式化）。
   * 範例：
       * 「計算 A1 到 A10 儲存格的平均值。」
       * 「查找 B2 儲存格的產品名稱在 產品清單 工作表中的對應價格。」
       * 「判斷 C5 儲存格的數值是否大於 100。」
4. 指定輸出格式 (Desired Format)
   * 定義：如果你對 AI 回傳的公式或其解釋有特定的格式要求，明確說明。
   * 範例：
       * 「給我一個 Excel 公式，計算 A1 到 A10 的總和。將公式用程式碼區塊呈現，並附上簡要的中文解釋。」
       * 「給我一個 Excel 公式，計算 A1 到 A10 的總和。以條列式說明公式的每個參數。」
5. 設定限制 (Constraints)
   * 定義：限制公式的行為或其結果的特性，例如錯誤處理、特定條件下的回傳值等。
   * 範例：
       * 「給我一個 Excel 公式，計算 B2 儲存格的銷售額減去 C2 儲存格的成本。確保公式在銷售額為零時不會產生錯誤，並回傳 0。」（限制了公式的錯誤處理行為）
       * 「給我一個 Excel 公式，判斷 A1 儲存格的數字是奇數還是偶數。如果 `A1` 為空，回傳空白。」（限制了公式在特定條件下的回傳值）
6. 提供範例 (Few-shot Examples)
   * 定義：如果你的需求比較複雜、抽象，或者你希望 AI 遵循特定的公式模式，提供一兩個輸入-輸出範例可以幫助 AI 更好地理解你的意圖。
   * 範例：
       * 「根據以下範例，為我生成 Excel 公式：
           * 範例 1：
               * 需求：計算 A1 到 A5 的總和。
               * 公式：=SUM(A1:A5)
           * 範例 2：
               * 需求：計算 B1 到 B10 的平均值。
               * 公式：=AVERAGE(B1:B10)
           * 現在請生成：
               * 需求：找出 C1 到 C20 的最大值。」（透過範例，AI 能理解你期望的公式生成模式）
7. 「忘記一切」的重設指令（Forget everything)
   * 定義：強制 AI 清除錯誤記憶與假設，強制重啟對話，解決 AI 陷入重複或迷失情境的問題。
   * 範例指令：「忘記從 [對話中的特定時間點] 開始的一切。重新開始並逐步解決這個問題。」
8. 啟動導師模式(like a teacher)
   * 定義：強迫 AI 在給出最終答案前，像是一位老師以淺顯易懂的方式逐步解釋推理過程，協助提高結果的準確性，讓使用者得以學習 AI 的思考邏輯。
   * 範例：「在給出最終答案前，請逐步解釋你的思考過程。」
---

> 實作練習：

1.  請打開你慣用的 AI 工具網頁（如 ChatGPT, Gemini 等）。
2.  **任務**：假設你正在分析客戶意見，請複製以下這段模擬的「客戶回饋文字」，並向 AI 提問。
    
    > **回饋文字**：「你們的App更新後變得很卡，而且常常閃退。雖然客服人員態度很好，但問題等了好幾天才解決。希望你們能改善穩定性，並加快問題處理速度。」
    >
    > **你的提問**：「請將這份客戶回饋進行分類，並總結出 3 個主要的客戶抱怨點。」
    
3.  觀察 AI 如何從非結構化的文字中，快速提煉出有價值的資訊。

---

## **單元二：讓 AI 成為你的 Excel 超級助理**

認識了 AI 的角色後，接下來我們要學習如何讓它在 Excel 的日常工作中助我們一臂之力。

### **1. 函數公式的解讀與生成**

你是否曾經被複雜的 `INDEX` + `MATCH` 公式搞得頭昏眼花？或是想了半天也想不出 `SUMIFS` 的條件該怎麼下？現在，你有了更好的解決方案！

*   **看不懂？問它！**：直接把看不懂的公式貼給 AI，請它用白話文解釋給你聽。
*   **寫不出？叫它寫！**：用自然語言描述你的需求，AI 就能為你生成對應的公式。

    *   **講師示範**：
        > 「我有兩張表，A 表是『訂單列表』(有產品ID)，B 表是『產品資訊』(有產品ID、產品名稱、價格)。請給我一個 Excel 公式，讓我在 A 表中根據『產品ID』查找到對應的『價格』。」

### **2. 自動化數據清理**

面對從系統導出的髒數據，例如格式混亂的地址、非標準的日期，過去我們可能要花費大量時間手動清理。現在，你可以透過向 AI 描述「處理前」與「處理後」的狀態，來快速獲得解決方案。

*   **示範**：
> 「我的 A 欄有一個地址列表，格式為『台灣台北市信義區市府路1號』，我只想在 B 欄提取出『台北市』，請問公式怎麼寫？」
```excel
=LEFT(TEXTAFTER(A1, "台灣"), MIN(FIND({"區","鄉","鎮","市"}, TEXTAFTER(A1, "台灣")&"區鄉鎮市"))-1)
```

> 少了市，修正錯誤

```excel
=LEFT(TEXTAFTER(A1, "台灣"), MIN(FIND({"市","縣"}, TEXTAFTER(A1, "台灣")&"市縣")))
```

> 實作練習：取出地址市區以外部分，如市府路1號
```excel
=TEXTAFTER(TEXTAFTER(G10, "市"), "區")
```
### **3. 如何問出好問題？**

要讓 AI 給出最精準的答案，關鍵在於「提問的品質」。請記住這個黃金框架，你的問題越清晰，AI 的回答就越到位：

1.  **背景 (Context)**：你在做什麼？目的是什麼？
2.  **目標 (Objective)**：你希望達成什麼具體的結果？
3.  **資料結構 (Data Structure)**：你的資料長什麼樣子？（最好提供欄位名稱和幾行範例）
4.  **預期輸出 (Expected Output)**：你希望 AI 給你的答案是什麼格式？（一個公式？還是一個步驟說明？）
5.  **環境 (Environment)**：你使用的 Excel 版本是什麼？（這會影響 AI 是否推薦 365 版的專屬新函數）

---

> 實作練習：

現在，讓我們打開練習檔案，實際操作看看！

1.  請打開我們提供的 `課堂練習.xlsx`。
2.  **任務一：公式生成**
    *   請你向 AI 提問，目標是將「農產品交易紀錄」中當天每個市場的總交易量的「市場的交易量」。
3.  **任務二：日期格式轉換**
    *   在員工資料表中，新增一欄「離職日期」的格式是文字（例如 `2023-Jan-15`）。
    *   向 AI 提問，找到一個最簡單的方法，將這一欄的文字轉換為 Excel 可辨識、可計算的標準日期格式。


農產品交易行情工作表的欄位F為市場名稱，欄位K為交易量，欄位D為作物名稱，依不同市場名稱將不同作物的交易量進行加總，結果輸出依序為市場名稱，作物名稱，總成交金額
```excel
=LET(
    市場作物, UNIQUE(CHOOSE({1,2}, 農產品交易行情!F:F, 農產品交易行情!D:D)),
    市場, INDEX(市場作物,,1),
    作物, INDEX(市場作物,,2),
    交易量, SUMIFS(農產品交易行情!K:K, 農產品交易行情!F:F, 市場, 農產品交易行情!D:D, 作物),
    HSTACK(市場, 作物, 交易量)
)
```
---

## **單元三：從數據到報告：一個完整的 AI 協作流程**

學會了單點的技巧後，我們要將它們串連起來，形成一個高效的工作流程。

### **標準 AI 協作工作流**

1.  **探索 (AI)**：針對你的原始數據，向 AI 提問：「我該從哪些角度分析？」
2.  **執行 (Excel)**：根據 AI 的建議，回到 Excel 中，利用你學過的樞紐分析等工具，快速完成數據的計算與分析。
3.  **解讀 (AI)**：將 Excel 的分析結果（例如，複製樞紐分析表的內容）貼回給 AI，並下指令：「請幫我解讀這份數據，並生成文字摘要與結論。」
4.  **呈現 (Excel)**：將 AI 生成的精闢摘要，稍作修飾後，放入你的 Excel 報告或儀表板中，讓你的報告不僅有數據，更有洞見！

### **優化你的報告**

你甚至可以請 AI 幫你優化報告的呈現方式！

*   **圖表美化**：截圖你的圖表，詢問 AI：「如何讓這張圖表更具可讀性？配色或標題有什麼建議？」
*   **生成摘要**：這是本單元的重點。學習如何將「量化結果」（表格）與「質化需求」（報告目標）結合，讓 AI 產出符合商業情境的分析短評。

    *   **示範**：
        
        > （貼上按渠道分類的瀏覽量樞紐分析表後）
        > 「你是一位資深的行銷分析師，這是我們今年的的銷售數據。請為我的行銷年報寫一段 100 字的摘要，並明確指出哪個渠道表現最好，哪個最需要我們關注。」

---

> 實作練習：jobs104.xlsx

1.  **步驟一 (探索)**：向 AI 提問，從這份數據中，找出 2-3 個值得分析的維度（例如：薪資競爭力與價值分析？關鍵人才供需熱點 ？）。
2.  **步驟二 (執行)**：在 Excel 中，根據 AI 的建議，自己動手建立對應的樞紐分析表。
3.  **步驟三 (解讀)**：將樞紐分析表的結果複製貼回 ChatGPT，並下達這個指令：
    > 「你是一位頂尖的數據分析師，請根據這份分析數據，為我的主管寫一段簡短的摘要，內容需包含關鍵發現與未來建議。」
    

    >1. 完成上傳檔案，prompt 輸入根據這份數據提供最重要的三個維度分析建議
    >2. 薪資競爭力與價值分析？關鍵人才供需熱點 ？如何建立excel樞紐分析表
    