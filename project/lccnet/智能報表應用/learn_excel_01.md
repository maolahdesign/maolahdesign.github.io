# Excel 函數基礎與進階

## 基礎函數

### 函數的基本概念與應用

- 甚麼是函數

  函數是一個預先設定好的「捷徑」或「工具」，用來幫你完成特定的計算或操作，省去手動處理的麻煩。

- 為什麼需要函數？

  因為非常有效率！

  * 想加總一百個數字？
     * 不需要手動 =A1+A2+A3+…
     * 只要使用 SUM 函數：=SUM(A1:A100)
  * 想找出全班最高的成績？
     * 不需要用眼睛一個一個看。
     * 只要使用 MAX 函數：=MAX(C2:C50)
  * 想知道今天幾月幾號？
     * 不需要自己手動輸入。
     * 只要使用 TODAY 函數：=TODAY()

- 函數語法結構：`=函數名稱(參數1, 參數2, ...)`

  例：`=SUM(A1:A10) → 將 A1 到 A10 的數值加總。`
---
#### 相對引用與絕對引用

**相對**：一定要有參照對象或比較基準，結果會因為參照不同而改變。
**絕對**：不用依賴任何參照、標準、對象；本身就是如此，而且對任何人、任何時候都是一樣的。

**生活實例**

|          | 舉例                  | 說明                             |
|----------|----------------------|----------------------------------|
| 絕對     | 水的沸點是100°C（在標準大氣壓下） | 無論你是誰、在哪裡，標準都不會改變 |
| 相對     | 這杯咖啡比那杯熱      | 需要跟另一杯做比較              |
| 絕對     | 一小時有 60 分鐘     | 全世界都一樣，標準固定           |
| 相對     | 我比你高              | 一定要有「你」當對象，才能成立   |

**科學與數學應用**

- 絕對溫度（如開氏溫標，起點為「絕對零度」）
- 相對溫度（今天比昨天溫度高3度，「比誰」很重要）
- 絕對值（數學上 $$|-5|=5$$，不考慮方向）
- 相對差異（A商品比B商品貴10%）

**參考實作**

* **相對引用 (A1)**：
  公式複製到其他儲存格時，參照的行列會隨著位置改變。例如在 B2 輸入 =A1+10，複製到 B3 會自動變成 =A2+10。
* **絕對引用 ($A$1)**：
    公式複製到其他儲存格時，參照的行列固定不變。例如 =$A$1+10 無論複製到哪裡都仍然參照 A1。
* **混合引用**：
  * $A1 → 鎖定欄，行隨位置改變
  * A$1 → 鎖定行，欄隨位置改變
  * **說明**：使用相對與絕對引用可以控制公式在複製時的參照行列，方便做批量計算或動態範圍。

**認識錯誤訊息**：

* `#DIV/0!`：當除數為 0 時出現，例如 =10/0。
* `#N/A`：表示沒有可用值或找不到匹配，例如 =VLOOKUP(5, A1:B3, 2, FALSE) 查無結果。
* `#VALUE!`：當數值或資料型態錯誤時，例如 ="文字"+5。

>實作練習：


---

### 常用函數介紹 

#### 運算函數

##### SUM 加總

* 定義：對指定範圍或數值加總。
* 使用語法：SUM(數值1, [數值2], ...)
* 實際範例：`=SUM(A1:A10)`。

>實作練習：計算銷售紀錄表總銷售額

##### SUMIF

* 定義：根據**單一條件**加總。
* 使用語法：SUMIF( 範圍,  條件,  [加總範圍] )  如果省略**加總範圍**，會加總**範圍**指定的儲存格。
* 實際範例：

1. 條件為「文字」

   最常見的用法，用來加總符合特定文字的項目。

    * 情境：計算所有「蘋果」的總銷售額。
    * 公式：`=SUMIF(A2:A9, "蘋果", C2:C9)`
    * 說明：
        * **範圍**是 A2:A9 (產品欄)。
        * **條件**是 "蘋果"。
        * **加總範圍**是 C2:C9 (銷售額欄)。
        * 公式會檢查 A 欄中所有值為 "蘋果" 的儲存格，並將其對應的 C 欄中的數值相加。
    * 結果：220
   
    >實作練習：計算員工資料表工程部員工總薪資

    ```excel
    =SUMIF(B2:B191,"工程部",E2:E191)
    or
    =SUMIF(B:B,"工程部",E:E)
    ```
    如何驗證錯誤?

2. 條件為「數字運算式」

    您可以使用大於 >、小於 <、等於 = 等運算子。
    
    * 情境：計算單筆銷售額「大於 150」的總金額。
    * 公式：`=SUMIF(C2:C9, ">150")`
    * 說明：
       * range 是 C2:C9。
       * criteria 是 ">150" (條件必須用雙引號括起來)。
       * 因為要判斷的範圍和要加總的範圍相同，所以 [sum_range] 參數可以省略。
       * 公式會加總 C 欄中所有大於 150 的數值 (200 和 250)。
    * 結果：450

3. 條件包含「萬用字元」

    您可以使用 * (星號，代表任意多個字元) 或 ? (問號，代表單一字元) 來進行模糊比對。
    注意:萬用字元 * 和 ? 只能在「文字」上運作，無法對「數值」進行模式比對
    
    * 情境：計算所有名稱中含有「筆」的產品的總銷售額。
    * 公式：`=SUMIF(A2:A9, "*筆", C2:C9)`
    * 說明：
       * criteria 是 "*筆"，這會匹配任何以 "筆" 結尾的文字，例如 "鉛筆" 和 "原子筆"。
       * 公式會將其對應的銷售額 (80 和 120) 相加。
    * 結果：200
    
    >實作練習：計算員工資料表部門名稱有"務"的部門員工總薪資

    ```excel
    =SUMIF(B:B, "*務?", E:E)
    ```

4. 條件為「不等於」

    使用 <> 運算子來排除特定項目。
    
    * 情境：計算除了「北區」以外，所有地區的總銷售額。
    * 公式：`=SUMIF(B2:B9, "<>北區", C2:C9)`
    * 說明：
    * criteria 是 "<>北區"，代表不等於 "北區"。
    * 此公式會加總所有地區不是 "北區" 的銷售額 (中區的 200 和 120，以及南區的 150)。
    * 結果：470
    
    >實作練習： 在員工資料表計算工程部員工總薪資

    ```excel
    =SUMIF(B2:B191,"工程部",E2:E191)
    or
    =SUMIF(B:B,"工程部",E:E)
    ```

##### SUMIFS

* 定義：根據**多條件**加總。
* 使用語法：SUMIFS(加總範圍, 條件範圍1, 條件1, ...)
* 實際範例：

 1. 兩個「文字」條件

    這是 SUMIFS 最典型的用法，結合兩個或多個欄位的文字條件。
    
    * 情境：計算「蘋果」在「北區」的總銷售額。
    * 公式：`=SUMIFS(C2:C9, A2:A9, "蘋果", B2:B9, "北區")`
    * 說明：
    * sum_range 是 C2:C9 (要加總銷售額)。
    * 第一個條件：A2:A9 (產品) 必須是 "蘋果"。
    * 第二個條件：B2:B9 (地區) 必須是 "北區"。
    * 只有第 2 列的資料 (蘋果, 北區, 100) 同時滿足這兩個條件。
    * 結果：100

2. 「文字」與「數字」條件組合

    您可以混合使用不同類型的條件。
    
     * 情境：計算「橘子」這個產品中，單筆銷售額「大於 200」的總金額。
     * 公式：`=SUMIFS(C2:C9, A2:A9, "橘子", C2:C9, ">200")`
     * 說明：
         * 加總範圍是 C2:C9。
         * 第一個條件：A2:A9 (產品) 必須是 "橘子"。
         * 第二個條件：C2:C9 (銷售額) 必須 ">200"。
         * 在所有 "橘子" 的紀錄中 (第 3 列和第 6 列)，只有第 6 列的銷售額 250 滿足 >200 的條件。
     * 結果：250

3. 多重條件與「不等於」

    結合多個條件，其中一個使用排除法。
    
    * 情境：計算「北區」所有「非蘋果」產品的總銷售額。
    * 公式：`=SUMIFS(C2:C9, B2:B9, "北區", A2:A9, "<>蘋果")`
    * 說明：
       * sum_range 是 C2:C7。
       * 第一個條件：B2:B9 (地區) 必須是 "北區"。
       * 第二個條件：A2:A9 (產品) 必須不等於 "<>" "蘋果"。
       * 首先篩選出北區的紀錄 (第 2, 5, 6 列)，然後在這些紀錄中，排除產品為 "蘋果" 的紀錄 (排除第 2 列)。最後加總剩下紀錄 (第 5 列和第 6 列) 的銷售額 (80 + 250)。
    * 結果：330
    
>實作練習：計算農產品交易紀錄台北一市場橄欖及栗子的總交易量

```excel
=SUMIFS(K:K,F:F,"台北一",D:D,"橄欖")+SUMIFS(K:K,F:F,"台北一",D:D,"栗子")
```

> **建議 :** 即使只有一個條件，也推薦使用 SUMIFS。因為它的語法結構更一致(加總範圍總是在最前面)，未來若需要增加篩選條件，可以直接在公式後面添加，而不需要將整個公式從 SUMIF 修改為 SUMIFS。

##### COUNT 統計

* 定義：只計算範圍中**包含「數值」的儲存格**。
* 使用語法：COUNT(範圍)
* 說明：它會忽略文字、錯誤值和空白儲存格。非常適合用來計算有多少筆**數字資料或日期**。
* 範例：`=COUNT(A1:A10)`

##### COUNTA

* 定義：計算範圍中**「非空白」的儲存格** (A 代表 All)。
* 使用語法：COUNTA(範圍)
* 說明：無論儲存格內容是數值、文字、日期、還是錯誤值 (#N/A)，**只要不是空的，COUNTA 都會計算進去**。常用來計算總共有多少筆「有資料」的紀錄。
* 範例：`=COUNTA(A1:A10)`

##### COUNTIF

* 定義：計算在一個範圍中，符合**「單一條件」**的儲存格數量。
* 使用語法：COUNTIF(範圍, 條件)
* 實際範例 1 (文字條件)：`=COUNTIF(B1:B20, "業務部")`
   * 說明：計算 A1:A50 範圍中，內容剛好是「業務部」的儲存格有幾個。
* 實際範例 2 (數字條件)：`=COUNTIF(B1:B50, ">10000")`
   * 說明：計算 B1:B50 範圍中，數值大於 10000 的儲存格有幾個。

##### COUNTIFS

* 定義：計算在多個範圍中，「同時」符合所有指定條件的儲存格數量。所有條件之間是「而且 (AND)」的關係。
* 使用語法：COUNTIFS(條件範圍1, 條件1, [條件範圍2, 條件2], ...)
* 實際範例：`=COUNTIFS(A1:A50, "業務部", C1:C50, "經理")`
   * 說明：計算所有符合以下兩個條件的紀錄總數：
       1. 在 A1:A50 範圍中，部門必須是「業務部」。
       2. 而且在 C1:C50 範圍中，其對應的職級必須是「經理」。
       
>實作練習：計算農產品交易紀錄三重區椰子的交易紀錄有幾筆

```excel
=COUNTIFS(F:F,"三重區",D:D,"椰子")
```

##### ROUND 四捨五入

* 定義：**四捨五入**數值。
* 使用語法：ROUND(數值, 位數)
* 實際範例：=ROUND(3.14159,2) → 3.14。

##### ROUNDUP 無條件進位

* 定義：**無條件**進位。
* 使用語法：ROUNDUP(數值, 位數)
* 實際範例：=ROUNDUP(3.14159,2) → 3.15。

##### ROUNDDOWN 無條件捨去

* 定義：無條件捨去。
* 使用語法：ROUNDDOWN(數值, 位數)
* 實際範例：=ROUNDDOWN(3.14159,2) → 3.14。

##### ABS 絕對值

* 定義：計算絕對值。
* 使用語法：ABS(數值)
* 實際範例：

1. 基本用法

    這是最直接的應用，了解 ABS 如何處理正數、負數和零。
    
    * 情境：直接轉換數字。
    * 公式與結果：
       * =ABS(7)
           * 結果：7 (正數維持不變)
       * =ABS(-7)
           * 結果：7 (負數的負號被移除)
       * =ABS(0)
           * 結果：0 (零維持不變)

2. 計算兩個數值的「差距」或「差異」

    在很多情況下，我們只關心兩個數字之間差了多少，而不在乎哪個數字比較大。
    
    * 情境：比較「預計銷售額」與「實際銷售額」，無論達標或未達標，只想知道差額是多少。
       * A2 儲存格 (預計)：5000
       * B2 儲存格 (實際)：4800
    * 公式：=ABS(B2 - A2)
    * 說明：
       * B2 - A2 的結果是 4800 - 5000 = -200。
       * ABS(-200) 會傳回 200。
       * 如果實際銷售額 (B2) 是 5300，B2 - A2 的結果是 300，ABS(300) 同樣傳回 300。
       * 這樣您就可以得到一個永遠為正數的差異值，方便後續計算或分析。

3. 應用於條件判斷 (IF 函式)

    ABS 常用於設定一個「容錯範圍」。
    
    * 情境：在品質檢測中，一個零件的標準長度是 10cm (在 A2)。只要測量出來的長度 (在 B2) 與標準長度的誤差在 0.05cm
     以內，就視為合格。
     * 公式：=IF(ABS(B2 - A2) <= 0.05, "合格", "不合格")
    * 說明：
       * 假設測量值 B2 是 10.03，ABS(10.03 - 10) 的結果為 0.03。因為 0.03 <= 0.05，所以公式會傳回 "合格"。
       * 假設測量值 B2 是 9.96，ABS(9.96 - 10) 的結果為 0.04。因為 0.04 <= 0.05，所以公式會傳回 "合格"。
       * 假設測量值 B2 是 9.94，ABS(9.94 - 10) 的結果為 0.06。因為 0.06 > 0.05，所以公式會傳回 "不合格"。
    * ABS 在這裡確保了無論測量值是偏大還是偏小，我們比較的都是誤差的絕對大小。
    
>實作練習：計算農產品交易紀錄平均價與中價物差大於 2 顯示狀態異常，否則為正常

```excel    
=IF(ABS(J2-H2)>=2,"異常","正常")
```

##### MOD 取餘數

* 定義：取餘數。
* 使用語法：MOD(數值, 除數)
* 實際範例：=MOD(10,3) → 1。

1. 判斷奇數或偶數

    這是 MOD 最經典的用法。任何數字除以 2，餘數若為 0 則是偶數，若為 1 則是奇數。
    
    - 情境：檢查 A2 儲存格的數字是奇數還是偶數。
    - 公式：=IF(MOD(A2, 2) = 0, "偶數", "奇數")
    - 說明：如果 A2 的值是 10，MOD(10, 2) 結果為 0，所以公式會傳回 "偶數"。

2. 製作間隔突顯的報表 (條件式格式化)

    當您希望報表中每隔幾列就標上不同顏色，讓報表更易讀時，MOD 就非常有用。
    
    - 情境：希望將表格中每三列就標示為淺灰色。
    - 步驟：
       1. 選取您想格式化的範圍 (例如：A2:E50)。
       2. 到「常用」->「條件式格式化」->「新增規則」。
       3. 選擇「使用公式來決定要格式化哪些儲存格」。
       4. 在公式欄位輸入：=MOD(ROW(), 3) = 0
       5. 點擊「格式」，設定您想要的背景色彩 (如淺灰色)。
    - 說明：ROW() 會傳回儲存格所在的列號。MOD(ROW(), 3) = 0 的意思是「當列數能被 3 整除時」，就套用此格式。

3. 分組或循環分配

    當您需要將一組項目循環分配給幾個人或幾個組別時，MOD 可以輕鬆完成。
    
    - 情境：您有一份名單 (在 A 欄)，需要將他們依序分配到 "甲組"、"乙組"、"丙組"。
    - 公式：=CHOOSE(MOD(ROW(A1)-1, 3) + 1, "甲組", "乙組", "丙組")
    - 說明：
       - ROW(A1)-1 會產生一個從 0 開始的序列 (0, 1, 2, 3, ...)。
       - MOD(..., 3) 會讓這個序列變成 (0, 1, 2, 0, 1, 2, ...)。
       - +1 讓序列變成 (1, 2, 3, 1, 2, 3, ...)。
       - CHOOSE 函式會根據第一個數字，選擇後面第 N 個值。所以當數字是 1 時選 "甲組"，2 時選 "乙組"，依此類推。

##### MAX 最大值

* 定義：求最大值。
* 使用語法：MAX(範圍)
* 實際範例：=MAX(A1:A10)。

>練習:  在員工資料表找出公司最高薪資是多少。

##### MIN 最小值

* 定義：求最小值。
* 使用語法：MIN(範圍)
* 實際範例：=MIN(A1:A10)。

>練習:  在員工資料表找出公司最低薪資。

##### AVERAGE 平均值

* 定義：求平均值。
* 使用語法：AVERAGE(範圍)
* 實際範例：=AVERAGE(A1:A10)。

>練習:  在員工資料表計算公司的平均薪資。

##### AVERAGEIFS 
* 定義：計算一個範圍內，符合所有指定條件 (AND 邏輯) 的儲存格的平均值。
* 使用語法：AVERAGEIFS(計算平均的儲存格範圍, 第一個要評估條件的儲存格範圍, 第一個評估條件, [第二個要評估條件的儲存格範圍, 第二個評估條件], ...)
* 實際範例：


1. 兩個「文字」條件

    計算同時滿足兩個文字條件的平均值。
    
    * 情境：計算「蘋果」在「北區」的平均銷售額。
    * 公式：`=AVERAGEIFS(C2:C9, A2:A9, "蘋果", B2:B9, "北區")`
    * 說明：
       * 範圍：C2:C9 (銷售額)。
       * 條件1：A2:A9 (產品) 必須是 "蘋果"。
       * 條件2：B2:B9 (地區) 必須是 "北區"。
       * 公式會找出 A 欄為 "蘋果" 且 B 欄為 "北區" 的所有紀錄，然後計算其對應 C 欄的平均值。
2. 「文字」與「數字」條件組合

    混合使用不同類型的條件。
    
    * 情境：計算「橘子」這個產品中，單筆銷售額「大於或等於 200」的平均金額。
    * 公式：`=AVERAGEIFS(C2:C9, A2:A9, "橘子", C2:C9, ">=100")`
    * 說明：
       * 找出 A 欄為 "橘子" 且 C 欄的數值 >=100 的所有紀錄。
       * 計算其對應銷售額的平均值。
3. 三個條件

    您可以堆疊多個條件來進行更精確的篩選。
    
    * 情境：計算「二月」份在「北區」所有「蘋果」產品的平均銷售額。
    * 公式：`=AVERAGEIFS(D2:D7, A2:A7, "二月", C2:C7, "北區", B2:B7, "蘋果")`
    * 說明：
       * 找出 A 欄為 "二月" 且 C 欄為 "北區" 且 B 欄為 "蘋果" 的紀錄。
       * 只有第 7 列 (二月, 蘋果, 北區, 180) 符合所有條件。
    * 計算：因為只有一筆符合，所以平均值就是其本身。
    
4. 使用「儲存格參照」作為條件 (最佳實踐)

    將條件寫在儲存格中，可以讓您的報表更有彈性，無需每次都修改公式。
    
    * 情境：假設您在 F2 儲存格輸入想查詢的「產品」，在 G2 儲存格輸入想查詢的「地區」。
       * F2 儲存格內容：蘋果
       * G2 儲存格內容：北區
    * 公式：=AVERAGEIFS(D2:D7, B2:B7, F2, C2:C7, G2)
    * 說明：公式中的條件直接參照 F2 和 G2 儲存格。當您改變 F2 或 G2 的內容 (例如改成
     "橘子")，公式結果會自動更新，非常靈活。
    * 結果：140 (與範例一相同，但更具彈性)
    
#### 日期與時間函數

##### YEAR 年

* 定義：取年份。
* 使用語法：YEAR(日期)
* 實際範例：`=YEAR("2025/10/02")` → 2025。

##### MONTH 月

* 定義：取月份。
* 使用語法：MONTH(日期)
* 實際範例：`=MONTH("2025/10/02")` → 10。

##### DAY 日

* 定義：取日。
* 使用語法：DAY(日期)
* 實際範例：`=DAY("2025/10/02")` → 2。

##### TODAY 今天

* 定義：傳回今天日期。
* 使用語法：TODAY()
* 實際範例：=TODAY()。

##### NOW 現在

* 定義：傳回當前日期與時間。
* 使用語法：NOW()
* 實際範例：=NOW()。

##### DATEVALUE

* 定義：將一個儲存為「文字 (Text)」格式的日期，轉換成 Excel 可辨識的「序列值 (Serial Number)」，這樣才能進行後續的日期計算或排序。
* 使用語法：DATEVALUE(文字日期)
* 實際範例：=DATEVALUE("2025/10/02")。

1. 基本轉換與格式設定

    這是最基本的用法，將一個標準的日期文字轉換成序列值。
    
    * 情境：將儲存格 A2 中的文字 "2025/10/15" 轉換為日期序列值。
    * 公式：=DATEVALUE(A2) 或 =DATEVALUE("2025/10/15")
    * 結果與說明：
       * 如果您將公式所在儲存格的格式設定為「通用格式」或「數值」，您會看到結果是 `45944`。這就是 2025/10/15
         的日期序列值。
       * 如果您將該儲存格的格式設定為「日期」，您才會看到熟悉的 `2025/10/15`。
       * 重點：DATEVALUE 產出的是數字，我們看到的外觀取決於儲存格的格式設定。

2. 處理不同的文字格式

    DATEVALUE 很聰明，可以辨識多種常見的日期文字格式 (辨識能力可能受您電腦的地區設定影響)。
    
    * 情境：您的資料來源有多種不同的日期文字格式。
    * 公式與結果 (均為序列值 `45944`)：
       * =DATEVALUE("15-Oct-2025")
       * =DATEVALUE("October 15, 2025")
       * =DATEVALUE("2025年10月15日")
    * 注意：如果您的日期文字格式很特殊 (例如 15.10.2025) 且 DATEVALUE 無法辨識，您可能需要先用 LEFT, MID, RIGHT 等文字函式將年、月、日拆分出來，再用 DATE 函式 (=DATE(年, 月, 日)) 將其組合成正確的日期。

3. 實際應用 - 日期計算

    這是 DATEVALUE 最重要的用途：讓文字格式的日期可以參與計算。
    
    * 情境：假設 A2 儲存格有一個從系統導出的文字格式的專案開始日期
     "2025/9/1"。您想計算到今天為止，專案已經進行了幾天。
    * 錯誤的公式：=TODAY() - A2
       * 這會傳回 #VALUE! 錯誤，因為 Excel 無法從「日期序列值」(由 TODAY() 產生) 中減去一個「文字」。
    * 正確的公式：=TODAY() - DATEVALUE(A2)
    * 說明：
       1. DATEVALUE(A2) 會先將文字 "2025/9/1" 轉換成其對應的序列值 (45900)。
       2. TODAY() 會傳回今天的日期序列值 (假設今天是 2025/10/15，序列值就是 45944)。
       3. 45944 - 45900 的結果就是 44。
       4. 這表示專案已經進行了 44 天。

##### TIMEVALUE

* 定義：將文字轉為時間。
* 使用語法：TIMEVALUE(文字時間)
* 實際範例：=TIMEVALUE("08:30")。

##### WEEKDAY

* 定義：回傳星期數字。
* 使用語法：WEEKDAY(日期, [回傳類型])
* 實際範例：=WEEKDAY("2025/10/02") → 5。

##### NETWORKDAYS

* 定義：計算工作日天數。
* 使用語法：NETWORKDAYS(開始日期, 結束日期, [假日])
  >假日: 一個包含假日日期的儲存格範圍，這些日期將不會被計為工作日。
* 實際範例：

1：基本用法 (不含假日)

   * 情境：計算 2025年10月15日 (在 A2) 到 2025年10月31日 (在 B2) 之間有幾個工作日。
   * 公式：`=NETWORKDAYS(A2, B2)`
   * 結果：13
       * 在這段期間總共有 17 天，扣除了 2 個週六和 2 個週日，所以是 13 個工作日。

2：包含自訂假日

   * 情境：同上，但這次我們要額外扣除一個國慶日補假 2025年10月10日 和一個公司活動日
     2025年10月20日。我們將這兩個假日日期寫在 D2 和 D3 儲存格。
       * A2: 2025/10/1
       * B2: 2025/10/31
       * D2: 2025/10/10
       * D3: 2025/10/20
   * 公式：`=NETWORKDAYS(A2, B2, D2:D3)`
   * 結果：21
       * 在 10 月份總共有 23 個工作日 (扣除 4 個週六和 4 個週日)。現在公式會再從這 23 天中扣除 10/10 (週五) 和
         10/20 (週一) 這兩個假日，所以 23 - 2 = 21。

  進階提示：NETWORKDAYS.INTL

  如果您的週末不是週六和週日，可以使用功能更強大的 NETWORKDAYS.INTL 函式。它允許您自訂哪天是週末。

   * 範例：假設您的公司是週日和週一休息。
   * 公式：=NETWORKDAYS.INTL(A2, B2, 2)
       * 第三個參數 2 代表「週日和週一」為週末。
       

   **設定週末的兩種設定方式**

   1. 使用「數字代碼」(常用)
       Excel 提供了一組數字 (1-17) 來代表常見的週末組合。


| 數字代碼   | 代表的週末     |
|:--:|:-:|
| 1 (或省略) | 星期六、星期日 |
| 2          | 星期日、星期一 |
| 3          | 星期一、星期二 |
| 4          | 星期二、星期三 |
| 5          | 星期三、星期四 |
| 6          | 星期四、星期五 |
| 7          | 星期五、星期六 |
| 11         | 只有星期日     |
| 12         | 只有星期一     |
| 13         | 只有星期二     |
| 14         | 只有星期三     |
| 15         | 只有星期四     |
| 16         | 只有星期五     |
| 17         | 只有星期六     |

   2. 使用「文字字串」(最靈活)
      這是最強大的方式，您可以傳入一個由 7 個 0 或 1 組成的文字字串，來定義一週中的每一天是否為工作日。

       * 字串固定為 7 位，第一位代表星期一，第七位代表星期日。
       * 1 代表非工作日 (休息日)。
       * 0 代表工作日。
      
      
       字串範例：
       * "0000011"：代表週六和週日休息 (與數字代碼 1 相同)。
       * "1000100"：代表週一和週五休息。
       * "0010000"：代表只有週三休息。
      
        `=NETWORKDAYS.INTL(A2, B2, "0010000")`

#### 邏輯函數

##### IF 假如

* 定義：條件判斷。
* 使用語法：IF(條件, 值_if_true, 值_if_false)
* 實際範例：=IF(A1>=60,"及格","不及格")。

>練習: 將公司薪資 38000 以下的員工薪資調高 4%。
```excel
=IF(E2 - 38000 > 0, E2, E2*1.04)
or
=IF(E2 > 38000, E2, E2*1.04)

```
##### IFS

* 定義：多重條件判斷。
* 使用語法：IFS(條件1, 結果1, 條件2, 結果2, ...)
* 實際範例：=IFS(A1>=90,"A",A1>=80,"B",A1>=70,"C")。

##### CHOOSE
* 定義：可以根據您提供的「索引數字 (第幾個)」，從後續一連串的「選項清單」中，挑選出對應位置的數值或項目。
* 使用語法： CHOOSE(索引數字, 選項1, [選項2], ...)
  * 索引數字 (index_num)：一個 1 到 254 之間的數字，用來決定要挑選第幾個選項。
  * 選項1, 選項2, ... (value1, value2, ...)：您提供的選項清單，可以是文字、數字、儲存格參照或另一個函式。
* 實際範例：

情境：根據 A1 儲存格的排名數字 (1, 2, 或 3)，顯示對應的獎牌「金牌」、「銀牌」或「銅牌」。

公式：

```excel
=CHOOSE(A1, "金牌", "銀牌", "銅牌")
```
* 說明：
   * 如果 A1 是 1，公式回傳「金牌」。
   * 如果 A1 是 2，公式回傳「銀牌」。
   * 如果 A1 是 3，公式回傳「銅牌」。
   * 如果 A1 是 1, 2, 3 以外的數字 (例如 4) 或文字，公式會傳回 #VALUE! 錯誤。


情境：A1 儲存格有一個日期 (例如 2025/10/15)，我們想知道那天是星期幾。

公式：

```excel
=CHOOSE(WEEKDAY(E2, 2), "星期一", "星期二", "星期三", "星期四", "星期五", "星期六", "星期日")
```
* 說明：
   1. WEEKDAY(A1, 2)：這個函式會計算 A1 日期是星期幾。參數 2 代表讓「星期一」等於 1，「星期二」等於
      2，依此類推。假設 2025/10/15 是星期三，WEEKDAY 就會傳回 3。
   2. CHOOSE(...)：CHOOSE 函式接收到數字 3 後，就會從後面的清單中挑選出第 3 個選項，也就是「星期三」。

情境：我們想從「東、南、西、北」四個組別中，隨機指派一個組別給某位員工。

公式：
```excel
=CHOOSE(RANDBETWEEN(1, 4), "東區", "南區", "西區", "北區")
```
* 說明：
   1. RANDBETWEEN(1, 4)：這個函式會隨機產生一個 1 到 4 之間的整數。
   2. CHOOSE(...)：根據 RANDBETWEEN 產生的隨機數字 (例如 2)，從清單中挑選出對應的組別
      (例如「南區」)。每次重算工作表 (例如按 F9)，結果都可能會改變。

##### AND 及、和

* 定義：同時滿足多個條件。
* 使用語法：AND(條件1, 條件2, ...)
* 實際範例：`=AND(B2="工程部",F2>50000)` → TRUE 或 FALSE。

##### OR 或

* 定義：任一條件成立。
* 使用語法：OR(條件1, 條件2, ...)
* 實際範例：=OR(A1>90,B1="台北") → TRUE 或 FALSE。

##### NOT 相反

* 定義：邏輯反轉。
* 使用語法：NOT(條件)
* 實際範例：`=NOT(A1>60)` → TRUE 或 FALSE。

##### IFERROR 假如出現錯誤

* 定義：錯誤處理。可以捕捉多種錯誤，包括 #N/A, #VALUE!, #REF!, #DIV/0!, #NUM!, #NAME? 等。
* 使用語法：IFERROR(值, 錯誤時回傳值)
* 實際範例：`=IFERROR(A2/B2,0)`
        1. Excel 嘗試計算 A2/B2。
        2. 如果 B2 不是 0：公式會回傳正常的計算結果（例如 0.25）。
        3. 如果 B2 是 0：計算會產生 #DIV/0! 錯誤。IFERROR 會捕捉到此錯誤，並回傳 0。
        4. 以農產品交易行情表說明總成交值 `=IFERROR(J2*K2,0)`

##### IFBLANK 假如是空的

* 定義：空白判斷。
* 使用語法：`=IF(ISBLANK(L2),"10/28",L2)` or `=IF(L2="","10/28",L2)`
* 實際範例：若 A1 空白，回


### 函數總整理表格

| 函式名稱        | 用途       | 使用語法                          |
| ----------- | -------- | ----------------------------- |
| SUM         | 數值加總     | SUM(數值1, [數值2], ... )         |
| SUMIF       | 單一條件加總   | SUMIF(範圍, 條件, [加總範圍])         |
| SUMIFS      | 多條件加總    | SUMIFS(加總範圍, 條件範圍1, 條件1, ...) |
| ROUND       | 四捨五入     | ROUND(數值, 位數)                 |
| ROUNDUP     | 無條件進位    | ROUNDUP(數值, 位數)               |
| ROUNDDOWN   | 無條件捨去    | ROUNDDOWN(數值, 位數)             |
| ABS         | 絕對值      | ABS(數值)                       |
| MOD         | 取餘數      | MOD(數值, 除數)                   |
| MAX         | 最大值      | MAX(範圍)                       |
| MIN         | 最小值      | MIN(範圍)                       |
| AVERAGE     | 平均值      | AVERAGE(範圍)                   |
| YEAR        | 取年份      | YEAR(日期)                      |
| MONTH       | 取月份      | MONTH(日期)                     |
| DAY         | 取日       | DAY(日期)                       |
| TODAY       | 當天日期     | TODAY()                       |
| NOW         | 當前日期與時間  | NOW()                         |
| DATEVALUE   | 文字轉日期    | DATEVALUE(文字日期)               |
| TIMEVALUE   | 文字轉時間    | TIMEVALUE(文字時間)               |
| WEEKDAY     | 回傳星期數字   | WEEKDAY(日期,[回傳類型])            |
| NETWORKDAYS | 計算工作日天數  | NETWORKDAYS(開始日期, 結束日期, [假日]) |
| IF          | 條件判斷     | IF(條件, 值_if_true, 值_if_false) |
| IFS         | 多重條件判斷   | IFS(條件1, 結果1, 條件2, 結果2, ...)  |
| AND         | 同時滿足多個條件 | AND(條件1, 條件2, ...)            |
| OR          | 任一條件成立   | OR(條件1, 條件2, ...)             |
| NOT         | 邏輯反轉     | NOT(條件)                       |
| IFERROR     | 錯誤處理     | IFERROR(值, 錯誤時回傳值)            |
| IFBLANK     | 空白判斷與替換  | IF(A1="","待補",A1)             |





